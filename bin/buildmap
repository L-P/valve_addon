#!/usr/bin/env sh

set -eux

map="$1"
bsp="$2"

exported="$(mktemp --suffix .map)"
hldir="$(realpath "$(dirname "$0")"/../..)"

goldutil map-export -cleanup-tb "$map" > "$exported"
qbsp -leaktest -hlbsp -wadpath "$hldir" "$exported" "$bsp"
vis "$bsp"
light "$bsp"
